!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((n="undefined"!=typeof globalThis?globalThis:n||self)["swap-jsbridge"]={})}(this,(function(n){"use strict";var e=function(n,e){return e&&(n="".concat(n).concat(n.match(/\?/)?"&":"?").concat(i(e))),n},t=function(n,e){return e&&(n="".concat(n,"?p=").concat(encodeURIComponent(JSON.stringify(e)))),n},o=function(n,o,i){var r="live",a={live:e,ws:t};if(i){var c=i.type;"custom"===c&&(a[c]=i.parseCallback),a[c]&&(r=c)}return a[r](n,o)},i=function(n){var e=[];for(var t in n)if(n.hasOwnProperty(t)){var o=void 0!==n[t]?n[t]:"";e.push(encodeURIComponent(t)+"="+encodeURIComponent(o))}return e.join("&")};function r(n,e,t){return n=o(n,e,t),setTimeout((function(){window.location.href=n}),0),n}function a(n,e,t){n=o(n,e,t);var i=document.createElement("iframe"),r=document.getElementsByTagName("body")[0];r.appendChild(i);var a={border:"none",height:0,left:0,margin:0,opacity:0,padding:0,position:"fixed",right:0,visibility:"hidden",width:0,zIndex:-1};for(var c in a)i.style[c]=a[c];return i.src=n,setTimeout((function(){try{r&&r.removeChild&&r.removeChild(i)}catch(n){}}),2e3),n}function c(n,e,t){return navigator.userAgent.match(/\bSafari\/\S+$/)&&navigator.userAgent.match(/\b(iPhone|iPad|iPod)\b/)?r(n,e,t):a(n,e,t)}var l,u=[],f=null,d=(l=0,function(n,e,t){return void 0===e&&(e={}),new Promise((function(o,i){var r="";e.callback?r=e.callback:(r="JSBRIDGE_CALLBACK_".concat(l++),e.callback=r),window[r]=function(n){o(n),delete window[r]},c(n,e,t)}))});n.call=function(n,e,t){u.push({url:n,param:e}),f&&(clearInterval(f),f=null),f=setInterval((function(){var n=u.shift();if(n)return c(n.url,n.param,t);clearInterval(f),f=null}),30)},n.callByIframe=a,n.callByLocation=r,n.callWithPromise=d}));

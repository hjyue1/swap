"use strict";var e=require("webpack"),t=require("webpack-sources"),s=require("fs"),r=require("path");function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=a(e),n=a(s),i=a(r),u="lib/esm/index.js",d="/Users/liudong/Desktop/demo/lerna/lerna-repo/packages/swap/config";const c=i.default.resolve(d,"../","node_modules/swap-sw/lib/esm","swapSW.js");var l={SERVICE_WORKER_SOURCE_PATH:c,SERVICE_WORKER_BUILD_PATH:i.default.resolve(d,"../",i.default.dirname(u),i.default.basename(c))},f=function(){function s(e,s){void 0===e&&(e=""),void 0===s&&(s=i.default.basename(l.SERVICE_WORKER_BUILD_PATH));var r=this;this.addAssets=function(e){var s=n.default.readFileSync(i.default.resolve(r.swPath));e.emitAsset(r.swName,new t.RawSource(s.toString()))},this.swName=s,this.swPath=this.searchWorkerPath(e)}return s.prototype.searchWorkerPath=function(e){if(e)return i.default.resolve(e);var t=i.default.resolve(__dirname,"../".concat(i.default.dirname(u)),this.swName);if(n.default.existsSync(t))return t;throw new Error("ServiceWorker File Not Found")},s.prototype.apply=function(t){var s=this;if(e.version.startsWith("4."))t.hooks.emit.tap(this.constructor.name,(function(e){return s.addAssets(e)}));else{var r=o.default.Compilation.PROCESS_ASSETS_STAGE_OPTIMIZE_TRANSFER;t.hooks.thisCompilation.tap(this.constructor.name,(function(e){e.hooks.processAssets.tap({name:s.constructor.name,stage:r-10},(function(){return s.addAssets(e)}))}))}},s}();module.exports=f;
